{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.getUsernameValidation = getUsernameValidation;\nexports.setUsername = setUsername;\nexports.usernameLooksLikeEmail = usernameLooksLikeEmail;\n\nvar _index = require('./index');\n\nvar _email = require('./email');\n\nvar _database = require('../connection/database');\n\nvar _trim = require('trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar DEFAULT_CONNECTION_VALIDATION = {\n  username: {\n    min: 1,\n    max: 15\n  }\n};\nvar regExp = /^[a-zA-Z0-9_+\\-.!#\\$\\^`~@']*$/;\n\nfunction validateUsername(str, validateFormat) {\n  var settings = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DEFAULT_CONNECTION_VALIDATION.username; // If the connection does not have validation settings, it should only check if the field is empty.\n  // validateFormat overrides this logic to disable validation on login (login should never validate format)\n\n  if (!validateFormat || settings == null) {\n    return (0, _trim2.default)(str).length > 0;\n  }\n\n  var lowercased = (0, _trim2.default)(str.toLowerCase()); // chekc min value matched\n\n  if (lowercased.length < settings.min) {\n    return false;\n  } // check max value matched\n\n\n  if (lowercased.length > settings.max) {\n    return false;\n  } // check allowed characters matched\n\n\n  var result = regExp.exec(lowercased);\n  return !!(result && result[0]);\n}\n\nfunction getUsernameValidation(m) {\n  var usernameValidation = (0, _database.databaseConnection)(m).getIn(['validation', 'username']);\n  return usernameValidation ? usernameValidation.toJS() : null;\n}\n\nfunction setUsername(m, str) {\n  var usernameStyle = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'username';\n  var validateUsernameFormat = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  var usernameValidation = validateUsernameFormat ? getUsernameValidation(m) : null;\n\n  var validator = function validator(value) {\n    switch (usernameStyle) {\n      case 'email':\n        return (0, _email.validateEmail)(value);\n\n      case 'username':\n        return validateUsername(value, validateUsernameFormat, usernameValidation);\n\n      default:\n        return usernameLooksLikeEmail(value) ? (0, _email.validateEmail)(value) : validateUsername(value, validateUsernameFormat, usernameValidation);\n    }\n  };\n\n  return (0, _index.setField)(m, 'username', str, validator);\n}\n\nfunction usernameLooksLikeEmail(str) {\n  return str.indexOf('@') > -1 && str.indexOf('.') > -1;\n}","map":{"version":3,"sources":["/Users/jacksonmccomas/Documents/Lambda/labs/startup-grant-database-fe/grantly/node_modules/auth0-lock/lib/field/username.js"],"names":["exports","__esModule","getUsernameValidation","setUsername","usernameLooksLikeEmail","_index","require","_email","_database","_trim","_trim2","_interopRequireDefault","obj","default","DEFAULT_CONNECTION_VALIDATION","username","min","max","regExp","validateUsername","str","validateFormat","settings","arguments","length","undefined","lowercased","toLowerCase","result","exec","m","usernameValidation","databaseConnection","getIn","toJS","usernameStyle","validateUsernameFormat","validator","value","validateEmail","setField","indexOf"],"mappings":"AAAA;;AAEAA,OAAO,CAACC,UAAR,GAAqB,IAArB;AACAD,OAAO,CAACE,qBAAR,GAAgCA,qBAAhC;AACAF,OAAO,CAACG,WAAR,GAAsBA,WAAtB;AACAH,OAAO,CAACI,sBAAR,GAAiCA,sBAAjC;;AAEA,IAAIC,MAAM,GAAGC,OAAO,CAAC,SAAD,CAApB;;AAEA,IAAIC,MAAM,GAAGD,OAAO,CAAC,SAAD,CAApB;;AAEA,IAAIE,SAAS,GAAGF,OAAO,CAAC,wBAAD,CAAvB;;AAEA,IAAIG,KAAK,GAAGH,OAAO,CAAC,MAAD,CAAnB;;AAEA,IAAII,MAAM,GAAGC,sBAAsB,CAACF,KAAD,CAAnC;;AAEA,SAASE,sBAAT,CAAgCC,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACX,UAAX,GAAwBW,GAAxB,GAA8B;AAAEC,IAAAA,OAAO,EAAED;AAAX,GAArC;AAAwD;;AAE/F,IAAIE,6BAA6B,GAAG;AAAEC,EAAAA,QAAQ,EAAE;AAAEC,IAAAA,GAAG,EAAE,CAAP;AAAUC,IAAAA,GAAG,EAAE;AAAf;AAAZ,CAApC;AACA,IAAIC,MAAM,GAAG,+BAAb;;AAEA,SAASC,gBAAT,CAA0BC,GAA1B,EAA+BC,cAA/B,EAA+C;AAC7C,MAAIC,QAAQ,GAAGC,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoET,6BAA6B,CAACC,QAAjH,CAD6C,CAG7C;AACA;;AACA,MAAI,CAACM,cAAD,IAAmBC,QAAQ,IAAI,IAAnC,EAAyC;AACvC,WAAO,CAAC,GAAGZ,MAAM,CAACG,OAAX,EAAoBO,GAApB,EAAyBI,MAAzB,GAAkC,CAAzC;AACD;;AAED,MAAIE,UAAU,GAAG,CAAC,GAAGhB,MAAM,CAACG,OAAX,EAAoBO,GAAG,CAACO,WAAJ,EAApB,CAAjB,CAT6C,CAW7C;;AACA,MAAID,UAAU,CAACF,MAAX,GAAoBF,QAAQ,CAACN,GAAjC,EAAsC;AACpC,WAAO,KAAP;AACD,GAd4C,CAgB7C;;;AACA,MAAIU,UAAU,CAACF,MAAX,GAAoBF,QAAQ,CAACL,GAAjC,EAAsC;AACpC,WAAO,KAAP;AACD,GAnB4C,CAqB7C;;;AACA,MAAIW,MAAM,GAAGV,MAAM,CAACW,IAAP,CAAYH,UAAZ,CAAb;AACA,SAAO,CAAC,EAAEE,MAAM,IAAIA,MAAM,CAAC,CAAD,CAAlB,CAAR;AACD;;AAED,SAAS1B,qBAAT,CAA+B4B,CAA/B,EAAkC;AAChC,MAAIC,kBAAkB,GAAG,CAAC,GAAGvB,SAAS,CAACwB,kBAAd,EAAkCF,CAAlC,EAAqCG,KAArC,CAA2C,CAAC,YAAD,EAAe,UAAf,CAA3C,CAAzB;AACA,SAAOF,kBAAkB,GAAGA,kBAAkB,CAACG,IAAnB,EAAH,GAA+B,IAAxD;AACD;;AAED,SAAS/B,WAAT,CAAqB2B,CAArB,EAAwBV,GAAxB,EAA6B;AAC3B,MAAIe,aAAa,GAAGZ,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,UAAxF;AACA,MAAIa,sBAAsB,GAAGb,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,IAAjG;AAEA,MAAIQ,kBAAkB,GAAGK,sBAAsB,GAAGlC,qBAAqB,CAAC4B,CAAD,CAAxB,GAA8B,IAA7E;;AAEA,MAAIO,SAAS,GAAG,SAASA,SAAT,CAAmBC,KAAnB,EAA0B;AACxC,YAAQH,aAAR;AACE,WAAK,OAAL;AACE,eAAO,CAAC,GAAG5B,MAAM,CAACgC,aAAX,EAA0BD,KAA1B,CAAP;;AACF,WAAK,UAAL;AACE,eAAOnB,gBAAgB,CAACmB,KAAD,EAAQF,sBAAR,EAAgCL,kBAAhC,CAAvB;;AACF;AACE,eAAO3B,sBAAsB,CAACkC,KAAD,CAAtB,GAAgC,CAAC,GAAG/B,MAAM,CAACgC,aAAX,EAA0BD,KAA1B,CAAhC,GAAmEnB,gBAAgB,CAACmB,KAAD,EAAQF,sBAAR,EAAgCL,kBAAhC,CAA1F;AANJ;AAQD,GATD;;AAWA,SAAO,CAAC,GAAG1B,MAAM,CAACmC,QAAX,EAAqBV,CAArB,EAAwB,UAAxB,EAAoCV,GAApC,EAAyCiB,SAAzC,CAAP;AACD;;AAED,SAASjC,sBAAT,CAAgCgB,GAAhC,EAAqC;AACnC,SAAOA,GAAG,CAACqB,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAApB,IAAyBrB,GAAG,CAACqB,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAApD;AACD","sourcesContent":["'use strict';\n\nexports.__esModule = true;\nexports.getUsernameValidation = getUsernameValidation;\nexports.setUsername = setUsername;\nexports.usernameLooksLikeEmail = usernameLooksLikeEmail;\n\nvar _index = require('./index');\n\nvar _email = require('./email');\n\nvar _database = require('../connection/database');\n\nvar _trim = require('trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar DEFAULT_CONNECTION_VALIDATION = { username: { min: 1, max: 15 } };\nvar regExp = /^[a-zA-Z0-9_+\\-.!#\\$\\^`~@']*$/;\n\nfunction validateUsername(str, validateFormat) {\n  var settings = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DEFAULT_CONNECTION_VALIDATION.username;\n\n  // If the connection does not have validation settings, it should only check if the field is empty.\n  // validateFormat overrides this logic to disable validation on login (login should never validate format)\n  if (!validateFormat || settings == null) {\n    return (0, _trim2.default)(str).length > 0;\n  }\n\n  var lowercased = (0, _trim2.default)(str.toLowerCase());\n\n  // chekc min value matched\n  if (lowercased.length < settings.min) {\n    return false;\n  }\n\n  // check max value matched\n  if (lowercased.length > settings.max) {\n    return false;\n  }\n\n  // check allowed characters matched\n  var result = regExp.exec(lowercased);\n  return !!(result && result[0]);\n}\n\nfunction getUsernameValidation(m) {\n  var usernameValidation = (0, _database.databaseConnection)(m).getIn(['validation', 'username']);\n  return usernameValidation ? usernameValidation.toJS() : null;\n}\n\nfunction setUsername(m, str) {\n  var usernameStyle = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'username';\n  var validateUsernameFormat = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n  var usernameValidation = validateUsernameFormat ? getUsernameValidation(m) : null;\n\n  var validator = function validator(value) {\n    switch (usernameStyle) {\n      case 'email':\n        return (0, _email.validateEmail)(value);\n      case 'username':\n        return validateUsername(value, validateUsernameFormat, usernameValidation);\n      default:\n        return usernameLooksLikeEmail(value) ? (0, _email.validateEmail)(value) : validateUsername(value, validateUsernameFormat, usernameValidation);\n    }\n  };\n\n  return (0, _index.setField)(m, 'username', str, validator);\n}\n\nfunction usernameLooksLikeEmail(str) {\n  return str.indexOf('@') > -1 && str.indexOf('.') > -1;\n}\n"]},"metadata":{},"sourceType":"script"}