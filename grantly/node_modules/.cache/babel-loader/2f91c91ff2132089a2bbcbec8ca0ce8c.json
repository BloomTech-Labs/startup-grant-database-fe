{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nexports.setField = setField;\nexports.registerOptionField = registerOptionField;\nexports.setOptionField = setOptionField;\nexports.isFieldValid = isFieldValid;\nexports.getFieldInvalidHint = getFieldInvalidHint;\nexports.isFieldVisiblyInvalid = isFieldVisiblyInvalid;\nexports.showInvalidField = showInvalidField;\nexports.hideInvalidFields = hideInvalidFields;\nexports.setFieldShowInvalid = setFieldShowInvalid;\nexports.clearFields = clearFields;\nexports.getField = getField;\nexports.getFieldValue = getFieldValue;\nexports.getFieldLabel = getFieldLabel;\nexports.phoneNumber = phoneNumber;\nexports.email = email;\nexports.vcode = vcode;\nexports.password = password;\nexports.username = username;\nexports.mfaCode = mfaCode;\nexports.isSelecting = isSelecting;\nexports.renderOptionSelection = renderOptionSelection;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _immutable = require('immutable');\n\nvar _trim = require('trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nvar _option_selection_pane = require('./option_selection_pane');\n\nvar _option_selection_pane2 = _interopRequireDefault(_option_selection_pane);\n\nvar _index = require('../core/index');\n\nvar l = _interopRequireWildcard(_index);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar minMax = function minMax(value, min, max) {\n  return value.length >= min && value.length <= max;\n};\n\nvar getDefaultValidator = function getDefaultValidator(field) {\n  switch (field) {\n    case 'family_name':\n    case 'given_name':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 150);\n      };\n\n    case 'name':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 300);\n      };\n\n    case 'nickname':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 300);\n      };\n\n    default:\n      return function (str) {\n        return (0, _trim2.default)(str).length > 0;\n      };\n  }\n};\n\nfunction setField(m, field, value) {\n  var validator = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : getDefaultValidator(field);\n  var prevValue = m.getIn(['field', field, 'value']);\n  var prevShowInvalid = m.getIn(['field', field, 'showInvalid'], false);\n\n  for (var _len = arguments.length, args = Array(_len > 4 ? _len - 4 : 0), _key = 4; _key < _len; _key++) {\n    args[_key - 4] = arguments[_key];\n  }\n\n  var validation = validate.apply(undefined, [validator, value].concat(args));\n  return m.mergeIn(['field', field], validation.merge({\n    value: value,\n    showInvalid: prevShowInvalid && prevValue === value\n  }));\n}\n\nfunction validate(validator, value) {\n  if (typeof validator != 'function') return (0, _immutable.Map)({\n    valid: true\n  });\n\n  for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n    args[_key2 - 2] = arguments[_key2];\n  }\n\n  var validation = validator.apply(undefined, [value].concat(args));\n  return validation && (typeof validation === 'undefined' ? 'undefined' : _typeof(validation)) === 'object' ? (0, _immutable.Map)({\n    valid: validation.valid,\n    invalidHint: validation.hint\n  }) : (0, _immutable.Map)({\n    valid: !!validation\n  });\n} // TODO: this should handle icons, and everything.\n// TODO: also there should be a similar fn for regular fields.\n\n\nfunction registerOptionField(m, field, options, initialValue) {\n  var valid = true,\n      hasInitial = !initialValue,\n      initialOption = void 0;\n  options.forEach(function (x) {\n    valid = valid && x.get('label') && typeof x.get('label') === 'string' && x.get('value') && typeof x.get('value') === 'string';\n\n    if (!hasInitial && x.get('value') === initialValue) {\n      initialOption = x;\n      hasInitial = true;\n    }\n  });\n\n  if (!valid || !options.size) {\n    var stopError = new Error('The options provided for the \"' + field + '\" field are invalid, they must have the following format: {label: \"non-empty string\", value: \"non-empty string\"} and there has to be at least one option.');\n    stopError.code = 'invalid_select_field'; // TODO: in the future we might want to return the result of the\n    // operation along with the model insteand of stopping the\n    // rendering, like [false, m] in the case of failure and [true, m]\n    // in the case of success.\n\n    return l.stop(m, stopError);\n  }\n\n  if (!initialOption) initialOption = (0, _immutable.Map)({});\n  return m.mergeIn(['field', field], initialOption, (0, _immutable.Map)({\n    options: options,\n    showInvalid: false,\n    valid: !initialOption.isEmpty()\n  }));\n}\n\nfunction setOptionField(m, field, option) {\n  return m.mergeIn(['field', field], option.merge((0, _immutable.Map)({\n    valid: true,\n    showInvalid: false\n  })));\n}\n\nfunction isFieldValid(m, field) {\n  return m.getIn(['field', field, 'valid']);\n}\n\nfunction getFieldInvalidHint(m, field) {\n  return m.getIn(['field', field, 'invalidHint'], '');\n}\n\nfunction isFieldVisiblyInvalid(m, field) {\n  return m.getIn(['field', field, 'showInvalid'], false) && !m.getIn(['field', field, 'valid']);\n}\n\nfunction showInvalidField(m, field) {\n  return m.setIn(['field', field, 'showInvalid'], !isFieldValid(m, field));\n}\n\nfunction hideInvalidFields(m) {\n  return m.update('field', function (fields) {\n    return fields && fields.map(function (field) {\n      return field.set('showInvalid', false);\n    });\n  });\n} // TODO: only used in passwordless, when we update it to use\n// validateAndSubmit this won't be needed anymore.\n\n\nfunction setFieldShowInvalid(m, field, value) {\n  return m.setIn(['field', field, 'showInvalid'], value);\n}\n\nfunction clearFields(m, fields) {\n  var keyPaths = void 0;\n\n  if (!fields || fields.length === 0) {\n    keyPaths = [['field']];\n  } else {\n    keyPaths = fields.map(function (x) {\n      return ['field', x];\n    });\n  }\n\n  return keyPaths.reduce(function (r, v) {\n    return r.removeIn(v);\n  }, m);\n}\n\nfunction getField(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new _immutable.Map({});\n  return m.getIn(['field', field], notFound);\n}\n\nfunction getFieldValue(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n  return getField(m, field).get('value', notFound);\n}\n\nfunction getFieldLabel(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n  return getField(m, field).get('label', notFound);\n} // phone number\n\n\nfunction phoneNumber(lock) {\n  return lock.getIn(['field', 'phoneNumber', 'value'], '');\n} // email\n\n\nfunction email(m) {\n  return getFieldValue(m, 'email');\n} // vcode\n\n\nfunction vcode(m) {\n  return getFieldValue(m, 'vcode');\n} // password\n\n\nfunction password(m) {\n  return getFieldValue(m, 'password');\n} // username\n\n\nfunction username(m) {\n  return getFieldValue(m, 'username');\n} // mfa_code\n\n\nfunction mfaCode(m) {\n  return getFieldValue(m, 'mfa_code');\n} // select field options\n\n\nfunction isSelecting(m) {\n  return !!m.getIn(['field', 'selecting']);\n}\n\nfunction renderOptionSelection(m) {\n  var name = m.getIn(['field', 'selecting', 'name']);\n  return isSelecting(m) ? _react2.default.createElement(_option_selection_pane2.default, {\n    model: m,\n    name: name,\n    icon: m.getIn(['field', 'selecting', 'icon']),\n    iconUrl: m.getIn(['field', 'selecting', 'iconUrl']),\n    items: m.getIn(['field', name, 'options'])\n  }) : null;\n}","map":{"version":3,"sources":["/Users/jacksonmccomas/Documents/Lambda/labs/startup-grant-database-fe/grantly/node_modules/auth0-lock/lib/field/index.js"],"names":["exports","__esModule","_typeof","Symbol","iterator","obj","constructor","prototype","setField","registerOptionField","setOptionField","isFieldValid","getFieldInvalidHint","isFieldVisiblyInvalid","showInvalidField","hideInvalidFields","setFieldShowInvalid","clearFields","getField","getFieldValue","getFieldLabel","phoneNumber","email","vcode","password","username","mfaCode","isSelecting","renderOptionSelection","_react","require","_react2","_interopRequireDefault","_immutable","_trim","_trim2","_option_selection_pane","_option_selection_pane2","_index","l","_interopRequireWildcard","newObj","key","Object","hasOwnProperty","call","default","minMax","value","min","max","length","getDefaultValidator","field","str","m","validator","arguments","undefined","prevValue","getIn","prevShowInvalid","_len","args","Array","_key","validation","validate","apply","concat","mergeIn","merge","showInvalid","Map","valid","_len2","_key2","invalidHint","hint","options","initialValue","hasInitial","initialOption","forEach","x","get","size","stopError","Error","code","stop","isEmpty","option","setIn","update","fields","map","set","keyPaths","reduce","r","v","removeIn","notFound","lock","name","createElement","model","icon","iconUrl","items"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.setField = setField;\nexports.registerOptionField = registerOptionField;\nexports.setOptionField = setOptionField;\nexports.isFieldValid = isFieldValid;\nexports.getFieldInvalidHint = getFieldInvalidHint;\nexports.isFieldVisiblyInvalid = isFieldVisiblyInvalid;\nexports.showInvalidField = showInvalidField;\nexports.hideInvalidFields = hideInvalidFields;\nexports.setFieldShowInvalid = setFieldShowInvalid;\nexports.clearFields = clearFields;\nexports.getField = getField;\nexports.getFieldValue = getFieldValue;\nexports.getFieldLabel = getFieldLabel;\nexports.phoneNumber = phoneNumber;\nexports.email = email;\nexports.vcode = vcode;\nexports.password = password;\nexports.username = username;\nexports.mfaCode = mfaCode;\nexports.isSelecting = isSelecting;\nexports.renderOptionSelection = renderOptionSelection;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _immutable = require('immutable');\n\nvar _trim = require('trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nvar _option_selection_pane = require('./option_selection_pane');\n\nvar _option_selection_pane2 = _interopRequireDefault(_option_selection_pane);\n\nvar _index = require('../core/index');\n\nvar l = _interopRequireWildcard(_index);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar minMax = function minMax(value, min, max) {\n  return value.length >= min && value.length <= max;\n};\n\nvar getDefaultValidator = function getDefaultValidator(field) {\n  switch (field) {\n    case 'family_name':\n    case 'given_name':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 150);\n      };\n    case 'name':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 300);\n      };\n    case 'nickname':\n      return function (str) {\n        return minMax((0, _trim2.default)(str), 1, 300);\n      };\n\n    default:\n      return function (str) {\n        return (0, _trim2.default)(str).length > 0;\n      };\n  }\n};\n\nfunction setField(m, field, value) {\n  var validator = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : getDefaultValidator(field);\n\n  var prevValue = m.getIn(['field', field, 'value']);\n  var prevShowInvalid = m.getIn(['field', field, 'showInvalid'], false);\n\n  for (var _len = arguments.length, args = Array(_len > 4 ? _len - 4 : 0), _key = 4; _key < _len; _key++) {\n    args[_key - 4] = arguments[_key];\n  }\n\n  var validation = validate.apply(undefined, [validator, value].concat(args));\n  return m.mergeIn(['field', field], validation.merge({\n    value: value,\n    showInvalid: prevShowInvalid && prevValue === value\n  }));\n}\n\nfunction validate(validator, value) {\n  if (typeof validator != 'function') return (0, _immutable.Map)({ valid: true });\n\n  for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n    args[_key2 - 2] = arguments[_key2];\n  }\n\n  var validation = validator.apply(undefined, [value].concat(args));\n  return validation && (typeof validation === 'undefined' ? 'undefined' : _typeof(validation)) === 'object' ? (0, _immutable.Map)({ valid: validation.valid, invalidHint: validation.hint }) : (0, _immutable.Map)({ valid: !!validation });\n}\n\n// TODO: this should handle icons, and everything.\n// TODO: also there should be a similar fn for regular fields.\nfunction registerOptionField(m, field, options, initialValue) {\n  var valid = true,\n      hasInitial = !initialValue,\n      initialOption = void 0;\n  options.forEach(function (x) {\n    valid = valid && x.get('label') && typeof x.get('label') === 'string' && x.get('value') && typeof x.get('value') === 'string';\n\n    if (!hasInitial && x.get('value') === initialValue) {\n      initialOption = x;\n      hasInitial = true;\n    }\n  });\n\n  if (!valid || !options.size) {\n    var stopError = new Error('The options provided for the \"' + field + '\" field are invalid, they must have the following format: {label: \"non-empty string\", value: \"non-empty string\"} and there has to be at least one option.');\n    stopError.code = 'invalid_select_field';\n    // TODO: in the future we might want to return the result of the\n    // operation along with the model insteand of stopping the\n    // rendering, like [false, m] in the case of failure and [true, m]\n    // in the case of success.\n    return l.stop(m, stopError);\n  }\n\n  if (!initialOption) initialOption = (0, _immutable.Map)({});\n\n  return m.mergeIn(['field', field], initialOption, (0, _immutable.Map)({\n    options: options,\n    showInvalid: false,\n    valid: !initialOption.isEmpty()\n  }));\n}\n\nfunction setOptionField(m, field, option) {\n  return m.mergeIn(['field', field], option.merge((0, _immutable.Map)({\n    valid: true,\n    showInvalid: false\n  })));\n}\n\nfunction isFieldValid(m, field) {\n  return m.getIn(['field', field, 'valid']);\n}\n\nfunction getFieldInvalidHint(m, field) {\n  return m.getIn(['field', field, 'invalidHint'], '');\n}\n\nfunction isFieldVisiblyInvalid(m, field) {\n  return m.getIn(['field', field, 'showInvalid'], false) && !m.getIn(['field', field, 'valid']);\n}\n\nfunction showInvalidField(m, field) {\n  return m.setIn(['field', field, 'showInvalid'], !isFieldValid(m, field));\n}\n\nfunction hideInvalidFields(m) {\n  return m.update('field', function (fields) {\n    return fields && fields.map(function (field) {\n      return field.set('showInvalid', false);\n    });\n  });\n}\n\n// TODO: only used in passwordless, when we update it to use\n// validateAndSubmit this won't be needed anymore.\nfunction setFieldShowInvalid(m, field, value) {\n  return m.setIn(['field', field, 'showInvalid'], value);\n}\n\nfunction clearFields(m, fields) {\n  var keyPaths = void 0;\n\n  if (!fields || fields.length === 0) {\n    keyPaths = [['field']];\n  } else {\n    keyPaths = fields.map(function (x) {\n      return ['field', x];\n    });\n  }\n\n  return keyPaths.reduce(function (r, v) {\n    return r.removeIn(v);\n  }, m);\n}\n\nfunction getField(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new _immutable.Map({});\n\n  return m.getIn(['field', field], notFound);\n}\n\nfunction getFieldValue(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n\n  return getField(m, field).get('value', notFound);\n}\n\nfunction getFieldLabel(m, field) {\n  var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n\n  return getField(m, field).get('label', notFound);\n}\n\n// phone number\n\nfunction phoneNumber(lock) {\n  return lock.getIn(['field', 'phoneNumber', 'value'], '');\n}\n\n// email\n\nfunction email(m) {\n  return getFieldValue(m, 'email');\n}\n\n// vcode\n\nfunction vcode(m) {\n  return getFieldValue(m, 'vcode');\n}\n\n// password\n\nfunction password(m) {\n  return getFieldValue(m, 'password');\n}\n\n// username\n\nfunction username(m) {\n  return getFieldValue(m, 'username');\n}\n\n// mfa_code\n\nfunction mfaCode(m) {\n  return getFieldValue(m, 'mfa_code');\n}\n\n// select field options\n\nfunction isSelecting(m) {\n  return !!m.getIn(['field', 'selecting']);\n}\n\nfunction renderOptionSelection(m) {\n  var name = m.getIn(['field', 'selecting', 'name']);\n  return isSelecting(m) ? _react2.default.createElement(_option_selection_pane2.default, {\n    model: m,\n    name: name,\n    icon: m.getIn(['field', 'selecting', 'icon']),\n    iconUrl: m.getIn(['field', 'selecting', 'iconUrl']),\n    items: m.getIn(['field', name, 'options'])\n  }) : null;\n}\n"]},"metadata":{},"sourceType":"script"}