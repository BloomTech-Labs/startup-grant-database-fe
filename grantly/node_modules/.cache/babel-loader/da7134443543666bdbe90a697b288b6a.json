{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.debouncedRequestAvatar = undefined;\nexports.requestAvatar = requestAvatar;\n\nvar _index = require('./store/index');\n\nvar _data_utils = require('./utils/data_utils');\n\nvar _preload_utils = require('./utils/preload_utils');\n\nvar preload = _interopRequireWildcard(_preload_utils);\n\nvar _fn_utils = require('./utils/fn_utils');\n\nvar f = _interopRequireWildcard(_fn_utils);\n\nvar _index2 = require('./core/index');\n\nvar l = _interopRequireWildcard(_index2);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nvar _dataFns = (0, _data_utils.dataFns)(['avatar']),\n    tget = _dataFns.tget,\n    tset = _dataFns.tset;\n\nvar cache = {};\n\nfunction requestAvatar(id, src) {\n  if (cache[src]) {\n    return update(id, src, cache[src].url, cache[src].displayName, true);\n  }\n\n  var provider = l.ui.avatarProvider((0, _index.read)(_index.getEntity, 'lock', id)).toJS();\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = tset(m, 'syncStatus', 'loading');\n    m = tset(m, 'src', src);\n    return m;\n  });\n  var url = void 0,\n      displayName = void 0;\n  provider.url(src, function (error, str) {\n    if (error) return handleError(id, src);\n    preload.img(str, function (error, img) {\n      if (error) return handleError(id, src);\n      url = img.src;\n      if (displayName !== undefined) handleSuccess(id, src, url, displayName);\n    });\n  });\n  provider.displayName(src, function (error, str) {\n    if (error) return handleError(id);\n    displayName = str;\n    if (url !== undefined) handleSuccess(id, src, url, displayName);\n  });\n}\n\nvar debouncedRequestAvatar = exports.debouncedRequestAvatar = f.debounce(requestAvatar, 300);\n\nfunction handleSuccess(id, src, url, displayName) {\n  cache[src] = {\n    url: url,\n    displayName: displayName\n  };\n  update(id, src, url, displayName);\n}\n\nfunction update(id, src, url, displayName) {\n  var force = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    if (force || tget(m, 'src') === src) {\n      m = tset(m, 'syncStatus', 'ok');\n      m = tset(m, 'url', url);\n      m = tset(m, 'src', src);\n      m = tset(m, 'displayName', displayName);\n    }\n\n    return m;\n  });\n}\n\nfunction handleError(id, src) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return tget(m, 'src') === 'src' ? tset(m, 'syncStatus', 'error') : m;\n  });\n}","map":{"version":3,"sources":["/Users/jacksonmccomas/Documents/Lambda/labs/startup-grant-database-fe/grantly/node_modules/auth0-lock/lib/avatar.js"],"names":["exports","__esModule","debouncedRequestAvatar","undefined","requestAvatar","_index","require","_data_utils","_preload_utils","preload","_interopRequireWildcard","_fn_utils","f","_index2","l","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","_dataFns","dataFns","tget","tset","cache","id","src","update","url","displayName","provider","ui","avatarProvider","read","getEntity","toJS","swap","updateEntity","m","error","str","handleError","img","handleSuccess","debounce","force","arguments","length"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\nexports.debouncedRequestAvatar = undefined;\nexports.requestAvatar = requestAvatar;\n\nvar _index = require('./store/index');\n\nvar _data_utils = require('./utils/data_utils');\n\nvar _preload_utils = require('./utils/preload_utils');\n\nvar preload = _interopRequireWildcard(_preload_utils);\n\nvar _fn_utils = require('./utils/fn_utils');\n\nvar f = _interopRequireWildcard(_fn_utils);\n\nvar _index2 = require('./core/index');\n\nvar l = _interopRequireWildcard(_index2);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar _dataFns = (0, _data_utils.dataFns)(['avatar']),\n    tget = _dataFns.tget,\n    tset = _dataFns.tset;\n\nvar cache = {};\n\nfunction requestAvatar(id, src) {\n  if (cache[src]) {\n    return update(id, src, cache[src].url, cache[src].displayName, true);\n  }\n\n  var provider = l.ui.avatarProvider((0, _index.read)(_index.getEntity, 'lock', id)).toJS();\n\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = tset(m, 'syncStatus', 'loading');\n    m = tset(m, 'src', src);\n    return m;\n  });\n\n  var url = void 0,\n      displayName = void 0;\n\n  provider.url(src, function (error, str) {\n    if (error) return handleError(id, src);\n\n    preload.img(str, function (error, img) {\n      if (error) return handleError(id, src);\n      url = img.src;\n      if (displayName !== undefined) handleSuccess(id, src, url, displayName);\n    });\n  });\n\n  provider.displayName(src, function (error, str) {\n    if (error) return handleError(id);\n    displayName = str;\n    if (url !== undefined) handleSuccess(id, src, url, displayName);\n  });\n}\n\nvar debouncedRequestAvatar = exports.debouncedRequestAvatar = f.debounce(requestAvatar, 300);\n\nfunction handleSuccess(id, src, url, displayName) {\n  cache[src] = { url: url, displayName: displayName };\n  update(id, src, url, displayName);\n}\n\nfunction update(id, src, url, displayName) {\n  var force = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    if (force || tget(m, 'src') === src) {\n      m = tset(m, 'syncStatus', 'ok');\n      m = tset(m, 'url', url);\n      m = tset(m, 'src', src);\n      m = tset(m, 'displayName', displayName);\n    }\n    return m;\n  });\n}\n\nfunction handleError(id, src) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return tget(m, 'src') === 'src' ? tset(m, 'syncStatus', 'error') : m;\n  });\n}\n"]},"metadata":{},"sourceType":"script"}