{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _index = require('../store/index');\n\nvar _error_screen = require('../core/error_screen');\n\nvar _error_screen2 = _interopRequireDefault(_error_screen);\n\nvar _loading_screen = require('../core/loading_screen');\n\nvar _loading_screen2 = _interopRequireDefault(_loading_screen);\n\nvar _social_or_email_login_screen = require('./passwordless/social_or_email_login_screen');\n\nvar _social_or_email_login_screen2 = _interopRequireDefault(_social_or_email_login_screen);\n\nvar _social_or_phone_number_login_screen = require('./passwordless/social_or_phone_number_login_screen');\n\nvar _social_or_phone_number_login_screen2 = _interopRequireDefault(_social_or_phone_number_login_screen);\n\nvar _ask_vcode = require('../connection/passwordless/ask_vcode');\n\nvar _ask_vcode2 = _interopRequireDefault(_ask_vcode);\n\nvar _last_login_screen = require('../core/sso/last_login_screen');\n\nvar _last_login_screen2 = _interopRequireDefault(_last_login_screen);\n\nvar _index2 = require('../connection/passwordless/index');\n\nvar _sync = require('../sync');\n\nvar _index3 = require('../core/index');\n\nvar l = _interopRequireWildcard(_index3);\n\nvar _quick_auth = require('../quick_auth');\n\nvar _index4 = require('../core/sso/index');\n\nvar sso = _interopRequireWildcard(_index4);\n\nvar _email = require('../field/email');\n\nvar _phone_number = require('../field/phone_number');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar setPrefill = function setPrefill(m) {\n  var _l$prefill$toJS = l.prefill(m).toJS(),\n      email = _l$prefill$toJS.email,\n      phoneNumber = _l$prefill$toJS.phoneNumber;\n\n  if (typeof email === 'string') {\n    m = (0, _email.setEmail)(m, email);\n  }\n\n  if (typeof phoneNumber === 'string') {\n    m = (0, _phone_number.setPhoneNumber)(m, phoneNumber);\n  }\n\n  return m;\n};\n\nvar Passwordless = function () {\n  function Passwordless() {\n    _classCallCheck(this, Passwordless);\n  }\n\n  Passwordless.prototype.didInitialize = function didInitialize(m, opts) {\n    m = (0, _index2.initPasswordless)(m, opts);\n    return m;\n  };\n\n  Passwordless.prototype.didReceiveClientSettings = function didReceiveClientSettings(m) {\n    var anySocialConnection = l.hasSomeConnections(m, 'social');\n    var anyPasswordlessConnection = l.hasSomeConnections(m, 'passwordless');\n\n    if (!anySocialConnection && !anyPasswordlessConnection) {\n      var error = new Error('At least one email, sms or social connection needs to be available.');\n      error.code = 'no_connection';\n      m = l.stop(m, error);\n    }\n\n    m = setPrefill(m);\n    return m;\n  };\n\n  Passwordless.prototype.render = function render(m) {\n    //if there's an error, we should show the error screen no matter what.\n    if (l.hasStopped(m)) {\n      return new _error_screen2.default();\n    } // TODO: remove the detail about the loading pane being pinned,\n    // sticky screens should be handled at the box module.\n\n\n    if (!(0, _sync.isDone)(m) || m.get('isLoadingPanePinned')) {\n      return new _loading_screen2.default();\n    }\n\n    if (!(0, _quick_auth.hasSkippedQuickAuth)(m)) {\n      if (l.ui.rememberLastLogin(m)) {\n        var lastUsedConnection = sso.lastUsedConnection(m);\n        var lastUsedUsername = sso.lastUsedUsername(m);\n\n        if (lastUsedConnection && (0, _sync.isSuccess)(m, 'sso') && l.hasConnection(m, lastUsedConnection.get('name')) && ['passwordless', 'social'].indexOf(l.findConnection(m, lastUsedConnection.get('name')).get('type')) >= 0 //if connection.type is either passwordless or social\n        ) {\n            var conn = l.findConnection(m, lastUsedConnection.get('name'));\n            var connectionType = conn.get('type');\n\n            if (connectionType === 'passwordless' || connectionType === 'social') {\n              return new _last_login_screen2.default();\n            }\n          }\n      }\n    }\n\n    if ((0, _index2.isEmail)(m)) {\n      return (0, _index2.isSendLink)(m) || !(0, _index2.passwordlessStarted)(m) ? new _social_or_email_login_screen2.default() : new _ask_vcode2.default();\n    } else {\n      return (0, _index2.passwordlessStarted)(m) ? new _ask_vcode2.default() : new _social_or_phone_number_login_screen2.default();\n    }\n  };\n\n  return Passwordless;\n}();\n\nexports.default = new Passwordless();","map":{"version":3,"sources":["/Users/jacksonmccomas/Documents/Lambda/labs/startup-grant-database-fe/grantly/node_modules/auth0-lock/lib/engine/passwordless.js"],"names":["exports","__esModule","_index","require","_error_screen","_error_screen2","_interopRequireDefault","_loading_screen","_loading_screen2","_social_or_email_login_screen","_social_or_email_login_screen2","_social_or_phone_number_login_screen","_social_or_phone_number_login_screen2","_ask_vcode","_ask_vcode2","_last_login_screen","_last_login_screen2","_index2","_sync","_index3","l","_interopRequireWildcard","_quick_auth","_index4","sso","_email","_phone_number","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","_classCallCheck","instance","Constructor","TypeError","setPrefill","m","_l$prefill$toJS","prefill","toJS","email","phoneNumber","setEmail","setPhoneNumber","Passwordless","didInitialize","opts","initPasswordless","didReceiveClientSettings","anySocialConnection","hasSomeConnections","anyPasswordlessConnection","error","Error","code","stop","render","hasStopped","isDone","get","hasSkippedQuickAuth","ui","rememberLastLogin","lastUsedConnection","lastUsedUsername","isSuccess","hasConnection","indexOf","findConnection","conn","connectionType","isEmail","isSendLink","passwordlessStarted"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _index = require('../store/index');\n\nvar _error_screen = require('../core/error_screen');\n\nvar _error_screen2 = _interopRequireDefault(_error_screen);\n\nvar _loading_screen = require('../core/loading_screen');\n\nvar _loading_screen2 = _interopRequireDefault(_loading_screen);\n\nvar _social_or_email_login_screen = require('./passwordless/social_or_email_login_screen');\n\nvar _social_or_email_login_screen2 = _interopRequireDefault(_social_or_email_login_screen);\n\nvar _social_or_phone_number_login_screen = require('./passwordless/social_or_phone_number_login_screen');\n\nvar _social_or_phone_number_login_screen2 = _interopRequireDefault(_social_or_phone_number_login_screen);\n\nvar _ask_vcode = require('../connection/passwordless/ask_vcode');\n\nvar _ask_vcode2 = _interopRequireDefault(_ask_vcode);\n\nvar _last_login_screen = require('../core/sso/last_login_screen');\n\nvar _last_login_screen2 = _interopRequireDefault(_last_login_screen);\n\nvar _index2 = require('../connection/passwordless/index');\n\nvar _sync = require('../sync');\n\nvar _index3 = require('../core/index');\n\nvar l = _interopRequireWildcard(_index3);\n\nvar _quick_auth = require('../quick_auth');\n\nvar _index4 = require('../core/sso/index');\n\nvar sso = _interopRequireWildcard(_index4);\n\nvar _email = require('../field/email');\n\nvar _phone_number = require('../field/phone_number');\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar setPrefill = function setPrefill(m) {\n  var _l$prefill$toJS = l.prefill(m).toJS(),\n      email = _l$prefill$toJS.email,\n      phoneNumber = _l$prefill$toJS.phoneNumber;\n\n  if (typeof email === 'string') {\n    m = (0, _email.setEmail)(m, email);\n  }\n  if (typeof phoneNumber === 'string') {\n    m = (0, _phone_number.setPhoneNumber)(m, phoneNumber);\n  }\n  return m;\n};\n\nvar Passwordless = function () {\n  function Passwordless() {\n    _classCallCheck(this, Passwordless);\n  }\n\n  Passwordless.prototype.didInitialize = function didInitialize(m, opts) {\n    m = (0, _index2.initPasswordless)(m, opts);\n\n    return m;\n  };\n\n  Passwordless.prototype.didReceiveClientSettings = function didReceiveClientSettings(m) {\n    var anySocialConnection = l.hasSomeConnections(m, 'social');\n    var anyPasswordlessConnection = l.hasSomeConnections(m, 'passwordless');\n\n    if (!anySocialConnection && !anyPasswordlessConnection) {\n      var error = new Error('At least one email, sms or social connection needs to be available.');\n      error.code = 'no_connection';\n      m = l.stop(m, error);\n    }\n    m = setPrefill(m);\n\n    return m;\n  };\n\n  Passwordless.prototype.render = function render(m) {\n    //if there's an error, we should show the error screen no matter what.\n    if (l.hasStopped(m)) {\n      return new _error_screen2.default();\n    }\n\n    // TODO: remove the detail about the loading pane being pinned,\n    // sticky screens should be handled at the box module.\n    if (!(0, _sync.isDone)(m) || m.get('isLoadingPanePinned')) {\n      return new _loading_screen2.default();\n    }\n\n    if (!(0, _quick_auth.hasSkippedQuickAuth)(m)) {\n      if (l.ui.rememberLastLogin(m)) {\n        var lastUsedConnection = sso.lastUsedConnection(m);\n        var lastUsedUsername = sso.lastUsedUsername(m);\n        if (lastUsedConnection && (0, _sync.isSuccess)(m, 'sso') && l.hasConnection(m, lastUsedConnection.get('name')) && ['passwordless', 'social'].indexOf(l.findConnection(m, lastUsedConnection.get('name')).get('type')) >= 0 //if connection.type is either passwordless or social\n        ) {\n            var conn = l.findConnection(m, lastUsedConnection.get('name'));\n            var connectionType = conn.get('type');\n            if (connectionType === 'passwordless' || connectionType === 'social') {\n              return new _last_login_screen2.default();\n            }\n          }\n      }\n    }\n\n    if ((0, _index2.isEmail)(m)) {\n      return (0, _index2.isSendLink)(m) || !(0, _index2.passwordlessStarted)(m) ? new _social_or_email_login_screen2.default() : new _ask_vcode2.default();\n    } else {\n      return (0, _index2.passwordlessStarted)(m) ? new _ask_vcode2.default() : new _social_or_phone_number_login_screen2.default();\n    }\n  };\n\n  return Passwordless;\n}();\n\nexports.default = new Passwordless();\n"]},"metadata":{},"sourceType":"script"}